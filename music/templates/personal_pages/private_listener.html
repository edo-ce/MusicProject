{% extends 'base.html' %}
{% block title %}
    Listener Page
{% endblock %}
{% block content %}
<body class="text-center">
    <section>
        {% with art = is_artist(current_user.username) %}
        {% if username == current_user.username %}
            {% if art %}
            <h1>My Uploads</h1>
            {% else %}
            <h1>My Library</h1>
            {% endif %}
        {% else %}
            {% if artist %}
            <h1>{{ is_artist(username).stage_name }}}</h1>
            {% else %}
            <h1> {{ username }} </h1>
            {% endif %}
        {% endif %}

        {% if art %}
            <meta class="art" data-name="artist">
        {% else %}
            <meta class="art" data-name="user">
        {% endif %}
        {% endwith %}

        {% for elem, values in elems.items() %}
        <div class="cards_landscape_wrap-2">
            <div class="container">
                <h1 class="fw-light">
                    {% if username == current_user.username %}My{% else %}{{ username }}'s{% endif %} {{ elem }}
                </h1>
                <div class="row">
                    {% for i in values %}
                    <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3 albums">
                        <!-- MUST PASS AN OBJECT WITH ['duration', 'copyright', 'genre', 'release_date', 'stage_name', 'bio', 'creator']
                         AS KEYS (NOT NECESSARY ALL, AT LEAST ONE)
                         TODO REVIEW JINJIA ARGUMENTS -->
                            <meta class="repr" data-name="{{ i.__repr__() }}" >
                            <meta class="id_elem" data-name="{{ i.id }}" >
                            <a class="details" style="cursor: pointer;">
                            <div class="card-flyer">
                                <div class="text-box">
                                    <div class="image-box img-conver">
                                        <!-- Image can be generated from the name
                                                in img.alt must be the title song/artist name -->
                                        {% if elem == 'artists' %}
                                        <img src="" alt="{{ i.stage_name }}" />
                                        {% elif elem == 'events' %}
                                        <img src="" alt="{{ i.name }}" />
                                        {% else %}
                                        <img src="" alt="{{ get_title(i.id) }}" />
                                        {% endif %}
                                    </div>
                                    <div class="text-container">
                                        <h6>
                                            {% if elem == 'artists' %}
                                                {{ i.stage_name }}
                                            {% elif elem == 'events' %}
                                                {{ i.name }}
                                            {% else %}
                                                {{ get_title(i.id) }}
                                            {% endif %}
                                        </h6>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endfor %}

        {% if is_artist(current_user.username) %}
        <br>
        <a href="{{ url_for('upload_album') }}"><h3>Upload an album</h3></a>
        <br>
        <a href="{{ url_for('upload_event') }}"><h3>Upload an event</h3></a>
        {% endif %}
        <br>
        <a href="{{ url_for('create_playlist') }}"><h3>Create a playlist</h3></a>

    </section>



</body>

    <script>

        window.onload = function () {
            var divs = document.querySelectorAll(".img-conver");
            for (const div of divs) {
                var img = div.children[0];
                var s = img.alt;
                img.src = convertStringToImageUrl(s);
            }

            showElementDetails()
        }

    </script>
{% endblock %}
